

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Plot Branches &mdash; Mysterious Messenger Wiki v3.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Creating Characters" href="creating-characters.html" />
    <link rel="prev" title="Setting up a Route" href="route-setup.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Mysterious Messenger Wiki
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="Home.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Full Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits-and-acknowledgements.html">Credits and Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="beginners-guide.html">Beginner’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="git-setup.html">Git Setup</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chatrooms.html">Chatrooms</a></li>
<li class="toctree-l1"><a class="reference internal" href="phone-calls.html">Phone Calls</a></li>
<li class="toctree-l1"><a class="reference internal" href="text-messages.html">Text Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="story-mode.html">Story Mode (VN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="emails.html">Emails</a></li>
<li class="toctree-l1"><a class="reference internal" href="route-setup.html">Setting up a Route</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Plot Branches</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#determining-which-path-to-branch-to">Determining Which Path to Branch To</a></li>
<li class="toctree-l2"><a class="reference internal" href="#branching-on-the-party">Branching on the Party</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plot-branch-examples">Plot Branch Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checking-for-participation">Checking for Participation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-for-guest-attendance">Checking for Guest Attendance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparing-heart-points">Comparing Heart Points:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="creating-characters.html">Creating Characters</a></li>
<li class="toctree-l1"><a class="reference internal" href="cg-albums.html">CG Albums</a></li>
<li class="toctree-l1"><a class="reference internal" href="miscellaneous.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mysterious Messenger Wiki</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Plot Branches</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/plot-branches.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plot-branches">
<h1>Plot Branches<a class="headerlink" href="#plot-branches" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Navigation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Plot Branches</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#determining-which-path-to-branch-to">Determining Which Path to Branch To</a></li>
<li class="toctree-l2"><a class="reference internal" href="#branching-on-the-party">Branching on the Party</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plot-branch-examples">Plot Branch Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checking-for-participation">Checking for Participation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-for-guest-attendance">Checking for Guest Attendance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparing-heart-points">Comparing Heart Points:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Example files to look at:</p>
<ul class="simple">
<li><p>route_setup.rpy</p></li>
<li><p>route_example.rpy</p></li>
<li><p>tutorial_8_plot_branches.rpy</p></li>
</ul>
<p><em>A brief overview of the steps required (more detail below):</em></p>
<ol class="arabic simple">
<li><p>In your list of RouteDay objects, add <code class="docutils literal notranslate"><span class="pre">plot_branch=PlotBranch(False)</span></code> or <code class="docutils literal notranslate"><span class="pre">plot_branch=PlotBranch(True)</span></code> as a parameter to the timeline item you want the plot branch to appear on.</p></li>
<li><p>Define another list of <code class="docutils literal notranslate"><span class="pre">RouteDay</span></code> objects for the path the player will branch onto. This should begin on the same RouteDay as the plot branch.</p></li>
<li><p>After the timeline item with the plot branch, create another label with the item label + the suffix <code class="docutils literal notranslate"><span class="pre">_branch</span></code> e.g. <code class="docutils literal notranslate"><span class="pre">label</span> <span class="pre">casual_day_4_10_branch</span></code></p></li>
<li><p>Fill out your criteria for branching. You can then either write <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">continue_route()</span></code> to have the player continue down the current path, or use <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">merge_routes(my_route_normal_end)</span></code> where <code class="docutils literal notranslate"><span class="pre">my_route_normal_end</span></code> is the path you defined in Step 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span></code> at the end of the plot branch label.</p></li>
</ol>
</div>
<p>To begin, you need a list of <code class="docutils literal notranslate"><span class="pre">RouteDay</span></code> objects for every path you want the user to be able to branch onto. For more on defining routes, see <a class="reference internal" href="route-setup.html#setting-up-a-route"><span class="std std-ref">Setting up a Route</span></a>. If you want this branch to have a title, the first entry in the list should be a string like “Emma Good End”.</p>
<p>This example will demonstrate a New Year’s Eve route with branching paths for the different characters. The New Year’s Eve Route is shown below:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">new_years_route</span> <span class="o">=</span> <span class="n">Route</span><span class="p">(</span>
    <span class="n">default_branch</span><span class="o">=</span><span class="n">new_years_normal_end</span><span class="p">,</span>
    <span class="n">branch_list</span><span class="o">=</span><span class="p">[</span><span class="n">new_years_ju</span><span class="p">,</span> <span class="n">new_years_ja</span><span class="p">,</span>
        <span class="n">new_years_s</span><span class="p">,</span> <span class="n">new_years_y</span><span class="p">,</span> <span class="n">new_years_z</span><span class="p">],</span>
    <span class="n">route_history_title</span><span class="o">=</span><span class="s2">&quot;New Year&#39;s&quot;</span><span class="p">,</span>
    <span class="n">history_background</span><span class="o">=</span><span class="s2">&quot;Menu Screens/Main Menu/new_years_route_bg.webp&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This example will focus on the definitions of three of the paths, the default branch <code class="docutils literal notranslate"><span class="pre">new_years_normal_end</span></code>, and the branches <code class="docutils literal notranslate"><span class="pre">new_years_ju</span></code>, and <code class="docutils literal notranslate"><span class="pre">new_years_z</span></code>.</p>
<p>The default branch of the route is defined as below.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">new_years_normal_end</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Normal End&quot;</span><span class="p">,</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;31st&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="n">ChatRoom</span><span class="p">(</span><span class="s2">&quot;The end of another year...&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;00:30&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">ja</span><span class="p">,</span> <span class="n">ju</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]),</span> <span class="c1"># 1</span>
        <span class="n">ChatRoom</span><span class="p">(</span><span class="s2">&quot;Resolutions&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;06:43&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">ja</span><span class="p">]),</span> <span class="c1"># 2</span>
        <span class="n">StoryMode</span><span class="p">(</span><span class="s2">&quot;At the office&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;09:44&#39;</span><span class="p">,</span> <span class="n">ju</span><span class="p">),</span> <span class="c1"># 3</span>
        <span class="n">ChatRoom</span><span class="p">(</span><span class="s2">&quot;A celebration?&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;12:12&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]),</span> <span class="c1"># 4</span>
        <span class="n">StoryCall</span><span class="p">(</span><span class="s2">&quot;Endings and beginnings&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;15:29&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="c1"># 5</span>
        <span class="n">ChatRoom</span><span class="p">(</span><span class="s2">&quot;Cats and chats&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;18:13&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">ju</span><span class="p">],</span> <span class="n">plot_branch</span><span class="o">=</span><span class="n">PlotBranch</span><span class="p">(</span><span class="kc">True</span><span class="p">)),</span> <span class="c1"># 6</span>
        <span class="n">ChatRoom</span><span class="p">(</span><span class="s2">&quot;Too busy...&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;17:50&#39;</span><span class="p">)</span> <span class="c1"># 7</span>
        <span class="p">],</span> <span class="n">auto_label</span><span class="o">=</span><span class="s1">&#39;new_years_t&#39;</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The plot branch will appear after the chatroom titled “Cats and chats”. A PlotBranch object takes one field:</p>
<dl>
<dt><cite>branch_story_mode</cite></dt><dd><p>If True, if the player proceeds through this plot branch and remains on this route, an attached Story Mode should appear after this item’s chatroom.</p>
<p>This is <em>only</em> applicable if the associated timeline item is a ChatRoom, as it is the only timeline item which may have an attached story mode.</p>
<p>By default, this field is False.</p>
</dd>
</dl>
<p>Because this plot branch has a <code class="docutils literal notranslate"><span class="pre">branch_story_mode</span></code>, there must be an associated Story Mode with the “Cats and chats” chatroom. The automatic labelling means that “Cats and chats” is found at <code class="docutils literal notranslate"><span class="pre">new_years_t6</span></code>, so it should have a corresponding Story Mode at a label like <code class="docutils literal notranslate"><span class="pre">new_years_t6_vn</span></code> (optionally with a character’s file_id as the suffix to associate this Story Mode with that character). This Story Mode will only appear if the player proceeds through the plot branch and remains on the Normal End.</p>
<p>Next, you must define the other paths for the route, in this case, <code class="docutils literal notranslate"><span class="pre">new_years_ju</span></code> and <code class="docutils literal notranslate"><span class="pre">new_years_z</span></code>:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">new_years_ju</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Jumin New Year&#39;s End&quot;</span><span class="p">,</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;31st&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="n">StoryMode</span><span class="p">(</span><span class="s2">&quot;Visiting the penthouse&quot;</span><span class="p">,</span> <span class="s1">&#39;jumin_ny_end&#39;</span><span class="p">,</span> <span class="s1">&#39;18:00&#39;</span><span class="p">,</span> <span class="n">ju</span><span class="p">)],</span>
        <span class="n">save_img</span><span class="o">=</span><span class="s1">&#39;ju&#39;</span><span class="p">,</span> <span class="n">day_icon</span><span class="o">=</span><span class="s1">&#39;ju&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">default</span> <span class="n">new_years_z</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Zen New Year&#39;s End&quot;</span><span class="p">,</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;31st&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="n">StoryMode</span><span class="p">(</span><span class="s2">&quot;A special visit&quot;</span><span class="p">,</span> <span class="s1">&#39;zen_ny_end&#39;</span><span class="p">,</span> <span class="s2">&quot;18:00&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">)],</span>
        <span class="n">save_img</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">day_icon</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span>
        <span class="n">branch_vn</span><span class="o">=</span><span class="n">BranchStoryMode</span><span class="p">(</span><span class="s1">&#39;zen_ny_branch_vn&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Note that the RouteDay is named the same as the RouteDay on the day with the plot branch – namely, “31st”. This tells the program that the timeline items on this RouteDay should be merged onto “31st Day” on the main route.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">new_year_z</span></code> definition, there is a special field called <code class="docutils literal notranslate"><span class="pre">branch_vn</span></code> on the RouteDay:</p>
<dl>
<dt><cite>branch_vn</cite></dt><dd><p>If given, an attached StoryMode will be created with the provided label (and optionally the provided character image). If the player merges onto this path after a plot branch, the chatroom which had the plot branch will have this Story Mode attached to it.</p>
<p>e.g. BranchStoryMode(“example_jaehee_be1_vn”)</p>
</dd>
</dl>
<p>A BranchStoryMode is a special convenience function to create an attached StoryMode for a plot branch. It has two fields:</p>
<dl>
<dt><cite>vn_label</cite></dt><dd><p>The label that this StoryMode is found at.</p>
<p>e.g. “example_jaehee_be2_vn”</p>
</dd>
<dt><cite>who</cite></dt><dd><p>Optional. The character whose image should be shown on the icon for this StoryMode in the timeline.</p>
<p>e.g. ja</p>
</dd>
</dl>
<div class="section" id="determining-which-path-to-branch-to">
<h2>Determining Which Path to Branch To<a class="headerlink" href="#determining-which-path-to-branch-to" title="Permalink to this headline">¶</a></h2>
<p>Now that the paths are all set up, you need to create a special label which will tell the program which path to branch onto when the player proceeds through the plot branch. This is the name of the label after which the plot branch occurs + <code class="docutils literal notranslate"><span class="pre">_branch</span></code>. So, for the New Year’s route, the automatic labelling puts the plot branch at the label <code class="docutils literal notranslate"><span class="pre">new_years_t6</span></code>. That means you will create the label:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">new_years_t6_branch</span><span class="p">:</span>
</pre></div>
</div>
<p>Inside this label, you need to create a conditional statement to tell the program how to proceed. There are many examples in <code class="docutils literal notranslate"><span class="pre">tutorial_8_plot_branches.rpy</span></code> as well as <code class="docutils literal notranslate"><span class="pre">route_example.rpy</span></code>.</p>
<p>The two main ways to branch are <code class="docutils literal notranslate"><span class="pre">continue_route</span></code> and <code class="docutils literal notranslate"><span class="pre">merge_routes</span></code>. If the player should continue on the same path they’re currently on (so, for the example, if they should continue on to the Normal End), then use <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">continue_route()</span></code> under your conditional statement.</p>
<p>On the other hand, if the player should be moved onto a separate route, then you need to use <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">merge_routes(new_year_z)</span></code> where <code class="docutils literal notranslate"><span class="pre">new_year_z</span></code> is the path the player should branch onto.</p>
<p>For the New Year’s route, the branch label may look like the following:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">new_years_t6_branch</span><span class="p">:</span>
    <span class="c1"># First, check if z or ju have more heart points</span>
    <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">and</span> <span class="n">z</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;</span> <span class="n">ju</span><span class="o">.</span><span class="n">heart_points</span><span class="p">:</span>
        <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_z</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ju</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_ju</span><span class="p">)</span>
    <span class="c1"># Otherwise, the player doesn&#39;t have enough heart points with</span>
    <span class="c1"># either character, so they get the Normal End</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">$</span> <span class="n">continue_route</span><span class="p">()</span>

    <span class="k">return</span>
</pre></div>
</div>
<p>This checks first if the player has at least 10 heart points with Zen, and then also if they have more points with Zen than with Jumin. If so, the player get’s Zen’s route.</p>
<p>Otherwise (<code class="docutils literal notranslate"><span class="pre">elif</span></code>), the program checks if the player has at least 10 heart points with Jumin. If so, they get Jumin’s route. Because of how the previous conditional was set up, if the player has the same number of points with Zen <em>and</em> Jumin, they will get Jumin’s ending.</p>
<p>Finally, if the player doesn’t have enough points with either character, they will get the Normal End (by continuing down the current path).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If the plot branch label returns without running either <code class="docutils literal notranslate"><span class="pre">continue_route</span></code> or <code class="docutils literal notranslate"><span class="pre">merge_routes</span></code>, <code class="docutils literal notranslate"><span class="pre">continue_route</span></code> will be run automatically and the player will continue down the current route.</p>
</div>
</div>
<div class="section" id="branching-on-the-party">
<h2>Branching on the Party<a class="headerlink" href="#branching-on-the-party" title="Permalink to this headline">¶</a></h2>
<p>You may also want to cause a branch to occur when the player clicks to enter the party, for example, to check how many guests are attending so that the player can branch onto either the Good End or the Normal End, as appropriate. This does not require any additional code in the route definition. So long as your timeline item is marked as the party – either via using <code class="docutils literal notranslate"><span class="pre">TheParty</span></code> to define it, using something like <code class="docutils literal notranslate"><span class="pre">StoryMode(&quot;The</span> <span class="pre">Party&quot;,</span> <span class="pre">&quot;my_party_label&quot;,</span> <span class="pre">&quot;12:00&quot;,</span> <span class="pre">party=True)</span></code>, or calling your attached Story Mode something like <code class="docutils literal notranslate"><span class="pre">my_timeline_label_party</span></code> (with the suffix <code class="docutils literal notranslate"><span class="pre">_party</span></code>) – then the program will automatically search for a branch label.</p>
<p>The branch label is searched for with the suffix <code class="docutils literal notranslate"><span class="pre">_branch</span></code>, so, if your party is found at the label <code class="docutils literal notranslate"><span class="pre">emma_route_good_party</span></code>, then the program will execute the label <code class="docutils literal notranslate"><span class="pre">emma_route_good_party_branch</span></code> before the player plays the party.</p>
<p>You can use this branch label as you would with any other branch label; however, if you <code class="docutils literal notranslate"><span class="pre">merge_routes</span></code>, the path which is being merged onto the main route will need to have a party on it that will be swapped out for the current party. e.g.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">emma_normal_end</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;Normal End&quot;</span><span class="p">,</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;Final&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">TheParty</span><span class="p">(</span><span class="s1">&#39;emma_route_normal_end&#39;</span><span class="p">,</span> <span class="s1">&#39;12:00&#39;</span><span class="p">)])</span>
<span class="p">]</span>
</pre></div>
</div>
<p>When the player clicks on the party, the program will check if there is a branch label. If so, it will execute the code in the branch label, which may involve merging onto a new path. If the player is merged onto a new path, they will go to the party label found on the merged route.</p>
</div>
<div class="section" id="plot-branch-examples">
<h2>Plot Branch Examples<a class="headerlink" href="#plot-branch-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="checking-for-participation">
<h3>Checking for Participation<a class="headerlink" href="#checking-for-participation" title="Permalink to this headline">¶</a></h3>
<p>You can check the percentage of timeline items the player has actively participated in (aka that haven’t expired) with a special function:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">participated_percentage</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
</pre></div>
</div>
<p>This checks if the percentage of chatrooms the player has participated in across days 1-4 is over 32%. Note that <code class="docutils literal notranslate"><span class="pre">4</span></code> in this case does not necessarily correspond to “4th Day”; since you may name your days whatever you please. If your route is defined like:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">my_route</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;25th&quot;</span><span class="p">),</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;31st&quot;</span><span class="p">),</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;45th&quot;</span><span class="p">),</span>
    <span class="n">RouteDay</span><span class="p">(</span><span class="s2">&quot;62nd&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Then <code class="docutils literal notranslate"><span class="pre">participated_percentage(1,</span> <span class="pre">4)</span></code> would be checking for the participation on the “25th” (1) day through to the “62nd” (4) day. This number is <em>inclusive</em>; aka <code class="docutils literal notranslate"><span class="pre">participated_percentage(1,</span> <span class="pre">4)</span></code> will total the number of timeline items found on the 25th/31st/45th/62nd days vs the number of timeline items participated in on those days and return that fraction as a whole number percentage (rounded down).</p>
<p>If you want to check for participation on a single day, you must pass it the same number for both the “first” and “last” days. For example, if you wanted to check for participation on just the “31st” day (from the above example), since it is the 2nd item in the list you would check:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">participated_percentage</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
</pre></div>
</div>
<p>If you want to check the participation from a particular day all the way to the end of the route, you can leave the second field blank e.g.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">participated_percentage</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">participated_percentage</span></code> only returns the proportion of participated timeline items vs <em>available</em> timeline items for a particular time range.</p>
<p>So, if you have 12 timeline items on the “6th” day and the plot branch is after the second item, if you calculate participation percentage on the “6th” day, the program will ignore the 10 timeline items which aren’t available. That means that if the player played the item just before the plot branch but missed the first item, they will have a 50% participation percentage that day since only 2/12 items were available and the player participated in 1/2 (50%) of those items.</p>
</div>
</div>
<div class="section" id="checking-for-guest-attendance">
<h3>Checking for Guest Attendance<a class="headerlink" href="#checking-for-guest-attendance" title="Permalink to this headline">¶</a></h3>
<p>You may also want to check how many guests are attending the party to determine which path to branch the player onto. The function <code class="docutils literal notranslate"><span class="pre">attending_guests()</span></code> returns the number of guests who will be attending the party at the time the function is called:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">attending_guests</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">my_route_good_end</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">my_route_normal_end</span><span class="p">)</span>
</pre></div>
</div>
<p>This is best used for the plot branch when clicking the party (see <a class="reference internal" href="#branching-on-the-party"><span class="std std-ref">Branching on the Party</span></a>). You can also check if individual guests are attending the party; see <a class="reference internal" href="emails.html#checking-in-game-if-a-guest-will-attend"><span class="std std-ref">Checking in-game if a Guest Will Attend</span></a>.</p>
</div>
<div class="section" id="comparing-heart-points">
<h3>Comparing Heart Points:<a class="headerlink" href="#comparing-heart-points" title="Permalink to this headline">¶</a></h3>
<p>Typically, the easiest way to compare heart points between characters is to check with:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;</span> <span class="n">ju</span><span class="o">.</span><span class="n">heart_points</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">seven_route</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">ju_route</span><span class="p">)</span>
</pre></div>
</div>
<p>However, if you have a complex plot branch in which you want to compare several characters’ heart points, you may find the following functions useful:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">$</span> <span class="n">sorted_heart_points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">heart_point_chars</span><span class="p">,</span>
    <span class="k">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">good_heart</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># sorted_heart_points now contains a list of the heart_point_chars, sorted</span>
<span class="c1"># in descending order from most heart points to least</span>

<span class="c1"># who is now equal to the character who has the most heart points</span>
<span class="k">$</span> <span class="n">who</span> <span class="o">=</span> <span class="n">sorted_heart_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># First, check if the character with the most heart points has at least</span>
<span class="c1"># 10 total heart points</span>
<span class="k">if</span> <span class="n">who</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="c1"># They don&#39;t have 10 heart points; continue down the Normal End</span>
    <span class="k">$</span> <span class="n">continue_route</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">who</span> <span class="o">==</span> <span class="n">ja</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_ja</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">who</span> <span class="o">==</span> <span class="n">ju</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_ju</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">who</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_s</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">who</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_y</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">who</span> <span class="o">==</span> <span class="n">z</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">merge_routes</span><span class="p">(</span><span class="n">new_year_z</span><span class="p">)</span>

<span class="k">return</span>
</pre></div>
</div>
<p>The sorted list saves you from writing out lengthy comparison statements such as:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">ja</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">and</span> <span class="n">ja</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;</span> <span class="n">ju</span><span class="o">.</span><span class="n">heart_points</span> <span class="k">and</span> <span class="n">ja</span><span class="o">.</span><span class="n">heart_points</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">heart_points</span> <span class="k">and</span><span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="creating-characters.html" class="btn btn-neutral float-right" title="Creating Characters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="route-setup.html" class="btn btn-neutral float-left" title="Setting up a Route" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Shawna P.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>